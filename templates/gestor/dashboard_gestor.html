<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="/static/img/icon.svg" type="image/x-icon">
    <title>Gestor - Dashboard</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <link rel="stylesheet" href="/static/css/style.css">
</head>

<body id="topo">
    <div class="wrapper">
        <aside id="sidebar" class="shadow-lg">
            <div class="d-flex justify-content-center">
                <button class="toggle-btn d-flex flex-column align-items-center p-0 pt-3 w-100" type="button">
                    <img src="/static/img/DipePreta.svg" width="40px" alt="">
                </button>
                <div class="sidebar-logo me-4">
                </div>
            </div>
            <ul class="sidebar-nav">
                <li class="sidebar-item">
                    <a href="/gestor/dashboard" class="sidebar-link active">
                        <i class="bi bi-house-door-fill"></i>
                        <span>Início</span>
                    </a>
                </li>
                <li class="sidebar-item mt-3">
                    <a href="/alunos" class="sidebar-link">
                        <i class="bi bi-person-fill"></i>
                        <span>Alunos</span>
                    </a>
                </li>
                <!-- Turmas -->
                <li class="sidebar-item">
                    <a href="#" class="sidebar-link collapsed has-dropdown" data-bs-toggle="collapse"
                        data-bs-target="#auth" aria-expanded="false" aria-controls="auth">
                        <i class="bi bi-people-fill"></i>
                        <span>Turmas <i class="bi-caret-down-fill ms-3 text-center"></i></span>
                    </a>
                    <ul id="auth" class="sidebar-dropdown list-unstyled collapse" data-bs-parent="#sidebar">
                        <li class="sidebar-item">
                            <a href="#" class="sidebar-link fw-normal"><i class="bi bi-mortarboard-fill me-3"></i>Redes de Computadores</a>
                        </li>
                        <li class="sidebar-item">
                            <a href="#" class="sidebar-link fw-normal"><i class="bi bi-mortarboard-fill me-3"></i>Agropecuária</a>
                        </li>
                    </ul>
                </li>
                <li class="sidebar-item mt-3">
                    <a href="/provas/cadastrar" class="sidebar-link">
                        <i class="bi bi-file-earmark-text-fill"></i>
                        <span>Cadastrar Prova</span>
                    </a>
                </li>
                <li class="sidebar-item mt-3">
                    <a href="#" class="sidebar-link">
                        <i class="bi bi-bar-chart-fill"></i>
                        <span>Resultados</span>
                    </a>
                </li>
                <div class="sidebar-item mt-3">
                    <form action="/sair" method="post" style="display: inline;">
                        <button type="submit" class="sidebar-link w-100 text-start">
                            <i class="bi bi-door-open-fill"></i>
                            <span class="fw-bold">Sair</span>
                        </button>
                    </form>
                </div>
            </ul>
            <div class="sidebar-footer">
                <a href="#topo" class="sidebar-link">
                    <i class="bi bi-arrow-up"></i>
                    <span>Voltar ao topo</span>
                </a>
            </div>
        </aside>

        <div class="main p-4 bg-pattern">
            <div class="row px-2">
                <div class="col-12 d-flex bg-secundaria rounded-4 borda justify-content-around">
                    <div class="d-flex flex-column justify-content-center">
                        <h4 class="fs-4 f-libre">Bem-vindo(a) Gestor,</h4>
                        <p class="fs-6 m-0">Acompanhe o desempenho geral dos alunos e as estatísticas do sistema.</p>
                    </div>
                    <div>
                        <img src="/static/img/welcome.svg" alt="" class="h-100">
                    </div>
                </div>

                <!-- <div class="col-12 p-0 m-0 mt-4 gap-5 d-flex">
                    <a href="/alunos" class="btn btn-secundario py-5 w-50 fs-4">Relatório de alunos</a>
                    <a href="/provas/cadastrar" class="btn btn-padrao text-light py-5 w-50 fs-4">Cadastrar provas</a>
                </div> -->

                <div class="col-12 mt-4">
                    <div class="row">
                        <!-- Desempenho por Disciplina -->
                        <div class="col-md-4 mb-4">
                            <div class="bg-branco borda rounded-4 p-3">
                                <h6 class="m-0 fw-semi">Desempenho por Disciplina</h6>
                                <canvas id="graficoDisciplina"></canvas>
                            </div>
                        </div>

                        
                        <!-- Progressão dos Alunos -->
                        <div class="col-md-4 mb-4">
                            <div class="bg-branco borda rounded-4 p-3">
                                <h6 class="m-0 fw-semi">Progressão dos Alunos</h6>
                                <canvas id="graficoProgressao"></canvas>
                            </div>
                        </div>
                        
                        <!-- Perfil dos Alunos -->
                        <div class="col-md-4 mb-4">
                            <div class="bg-branco borda rounded-4 p-3">
                                <h6 class="m-0 fw-semi">Perfil dos Alunos por Idade</h6>
                                <canvas id="graficoPerfil"></canvas>
                            </div>
                        </div>
                        
                        <!-- Distribuição das Notas -->
                        <div class="col-md-6 mb-4">
                            <div class="bg-branco borda rounded-4 p-3">
                                <h6 class="m-0 fw-semi">Distribuição das Notas</h6>
                                <canvas id="graficoDistribuicao"></canvas>
                            </div>
                        </div>

                        <!-- Comparação entre Turmas -->
                        <div class="col-md-6 mb-4">
                            <div class="bg-branco borda rounded-4 p-3">
                                <h6 class="m-0 fw-semi">Comparação entre Turmas</h6>
                                <canvas id="graficoTurmas"></canvas>
                            </div>
                        </div>
                        <!-- Número de Alunos por Turma -->
                        <div class="col-md-6 mb-4">
                            <div class="bg-branco borda rounded-4 p-3">
                                <h6 class="m-0 fw-semi">Número de Alunos por Turma</h6>
                                <canvas id="graficoAlunosTurma"></canvas>
                            </div>
                        </div>

                        <!-- Taxa de Participação -->
                        <div class="col-md-6 mb-4">
                            <div class="bg-branco borda rounded-4 p-3">
                                <h6 class="m-0 fw-semi">Taxa de Participação</h6>
                                <canvas id="graficoParticipacao"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Parsear os dados do backend
        const dados = JSON.parse('{{ dados | safe }}');

        // Função para criar gráficos de barra
        function criarGraficoBarra(id, labels, data, label, cor) {
            new Chart(document.getElementById(id), {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: label,
                        data: data,
                        backgroundColor: cor,
                        borderColor: cor.replace('0.5', '1'),
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // Função para criar gráficos de linha
        function criarGraficoLinha(id, labels, data, label, cor) {
            new Chart(document.getElementById(id), {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: label,
                        data: data,
                        fill: false,
                        borderColor: cor,
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // Função para criar gráficos de pizza
        function criarGraficoPizza(id, labels, data, cores) {
            new Chart(document.getElementById(id), {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: cores
                    }]
                },
                options: {
                    responsive: true
                }
            });
        }

        // Criar os gráficos
        criarGraficoBarra('graficoDisciplina', 
            dados.desempenho_disciplina.labels, 
            dados.desempenho_disciplina.data, 
            'Média de Acertos', 
            'rgba(54, 162, 235, 0.5)'
        );

        criarGraficoBarra('graficoDistribuicao', 
            dados.distribuicao_notas.labels, 
            dados.distribuicao_notas.data, 
            'Quantidade de Alunos', 
            'rgba(255, 99, 132, 0.5)'
        );

        // Gráfico de Comparação entre Turmas
        new Chart(document.getElementById('graficoTurmas'), {
            type: 'bar',
            data: {
                labels: dados.comparacao_turmas.labels,
                datasets: [{
                    label: 'Média de Acertos',
                    data: dados.comparacao_turmas.data,
                    backgroundColor: [
                        'rgba(75, 192, 192, 0.5)',
                        'rgba(54, 162, 235, 0.5)',
                        'rgba(255, 99, 132, 0.5)',
                        'rgba(255, 206, 86, 0.5)',
                        'rgba(153, 102, 255, 0.5)'
                    ],
                    borderColor: [
                        'rgba(75, 192, 192, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 99, 132, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(153, 102, 255, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        criarGraficoLinha('graficoProgressao', 
            dados.progressao_alunos.labels, 
            dados.progressao_alunos.data, 
            'Média de Acertos', 
            'rgba(153, 102, 255, 1)'
        );

        criarGraficoPizza('graficoAlunosTurma', 
            dados.alunos_por_turma.labels, 
            dados.alunos_por_turma.data, 
            [
                'rgba(54, 162, 235, 0.5)',
                'rgba(75, 192, 192, 0.5)',
                'rgba(255, 99, 132, 0.5)',
                'rgba(255, 206, 86, 0.5)',
                'rgba(153, 102, 255, 0.5)'
            ]
        );

        criarGraficoBarra('graficoPerfil', 
            dados.perfil_idade.labels, 
            dados.perfil_idade.data, 
            'Quantidade de Alunos', 
            'rgba(255, 159, 64, 0.5)'
        );

        criarGraficoPizza('graficoParticipacao', 
            dados.taxa_participacao.labels, 
            dados.taxa_participacao.data, 
            [
                'rgba(75, 192, 192, 0.5)',
                'rgba(255, 99, 132, 0.5)'
            ]
        );
    </script>
    <script src="/static/js/menu.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
        crossorigin="anonymous"></script>
</body>

</html> 